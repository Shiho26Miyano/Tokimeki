<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tokimeki</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nouislider@15.7.1/dist/nouislider.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />
    <style>
        body { font-family: Inter, Roboto, Arial, sans-serif; background: #fff; color: #222; }
        .container { max-width: 900px; margin: 0 auto; padding-top: 2.5rem; }
        .letsplay-row img { width: 60px; height: 60px; object-fit: cover; border-radius: 14px; box-shadow: 0 2px 8px rgba(0,0,0,0.13); margin-bottom: 4px; }
        .letsplay-row h1 { font-size: 1.5rem; color: #183153; letter-spacing: 0.5px; margin: 0; font-weight: 700; }
        .noUi-target { background: #e0e0e0; border-radius: 8px; border: none; height: 8px; margin-top: 18px; }
        .noUi-connect { background: #183153; border-radius: 8px; }
        .noUi-horizontal .noUi-handle { width: 18px; height: 18px; border-radius: 50%; background: #183153; border: 2px solid #fff; top: -5px; cursor: pointer; }
        .noUi-tooltip { background: #fff; color: #183153; border-radius: 6px; border: 1px solid #183153; font-size: 0.95em; padding: 2px 8px; }
        select:disabled { background: #f3f3f3; color: #aaa; border-color: #ddd; cursor: not-allowed; }
        .row.g-4 { gap: 1.5rem 0; flex-direction: column; }
        .card { min-height: 100%; background: #fff; border: 1px solid #e0e0e0; box-shadow: 0 2px 16px rgba(16,26,43,0.07); border-radius: 14px; padding: 1.2rem 1.2rem 1.2rem 1.2rem; display: flex; flex-direction: column; justify-content: stretch; margin-bottom: 1.5rem; }
        .card-header-row { display: flex; flex-wrap: wrap; align-items: center; gap: 1.1rem; margin-bottom: 0.7rem; }
        .card-title { font-family: Inter, Roboto, Arial, sans-serif; font-size: 1.1rem; font-weight: 600; color: #183153; letter-spacing: 0.01em; text-align: left; margin-bottom: 0; line-height: 1.1; text-transform: none; white-space: nowrap; }
        .card-section-vertical { display: flex; flex-direction: column; gap: 0.7rem; }
        .chart-area { background: #fff; border-radius: 12px; padding: 0.7rem 0.7rem 0.7rem 0.7rem; min-width: 320px; width: 100%; max-width: 700px; height: 260px; aspect-ratio: unset; display: flex; align-items: center; justify-content: center; overflow: hidden; margin: 0 auto; }
        #d3-stock-chart, #d3-stability-chart, #volatility-correlation-chart { width: 100%; height: 100%; min-height: 0; min-width: 0; max-width: 100%; margin: 0 auto; overflow-x: auto; background: transparent; }
        .market-controls, .explore-controls, .poetry-controls { display: flex; flex-wrap: wrap; align-items: center; gap: 0.7rem; margin-bottom: 0; }
        .market-controls .form-label, .form-label { color: #222; font-weight: 500; font-size: 1rem; margin-bottom: 0; white-space: nowrap; }
        .btn-dark-bbg { background: #183153; color: #fff; font-weight: 500; border: none; font-size: 1rem; padding: 0.38rem 1.1rem; }
        .btn-dark-bbg:hover { background: #27457c; color: #fff; }
        .btn-outline-secondary { border-color: #183153; color: #183153; background: transparent; font-size: 1rem; padding: 0.38rem 1.1rem; }
        .btn-outline-secondary:hover { background: #183153; color: #fff; }
        .form-select, .form-control { background: #fff; color: #222; border: 1px solid #ccc; font-size: 1rem; }
        .form-select:focus, .form-control:focus { border-color: #183153; box-shadow: 0 0 0 2px #18315333; }
        .mb-2, .mb-3, .mb-4 { margin-bottom: 1.1rem !important; }
        .mb-4 { margin-bottom: 1.5rem !important; }
        .d-flex.align-items-end.gap-2 { gap: 0.5rem; }
        .row.g-4 > [class^='col-'] { display: flex; flex-direction: column; }
        .card-body { flex: 1 1 auto; display: flex; flex-direction: column; }
        .divider { display: none; }
        @media (max-width: 991px) {
            .container { padding: 1rem; }
            .card-header-row, .market-controls, .explore-controls, .poetry-controls { flex-direction: column; align-items: flex-start; gap: 0.5rem; }
            .chart-area { min-width: 0; max-width: 100%; width: 100%; height: 220px; }
        }
    </style>
</head>
<body>
    <div class="container py-4">
        <div class="letsplay-row d-flex align-items-center justify-content-center gap-3 mb-4 flex-wrap">
            <div class="text-center">
                <img src="static/img/cute.png" alt="Cute">
            </div>
            <div class="flex-grow-1 text-center">
                <h1>Let's PLAY &gt;w&lt;</h1>
            </div>
            <div class="text-center">
                <img src="static/img/handsome.png" alt="Handsome">
            </div>
        </div>
        <div class="row g-4 justify-content-center align-items-stretch">
            <!-- Market Overtime -->
            <div class="col-12 d-flex">
                <div class="card shadow-sm flex-fill d-flex flex-column">
                    <div class="card-body d-flex flex-column">
                        <div class="card-header-row flex-column align-items-stretch" style="gap:0.5rem;">
                            <div class="d-flex flex-wrap align-items-center gap-2 mb-2">
                                <label for="stock-select" class="form-label">Select companies:</label>
                                <select id="stock-select" class="form-select" multiple>
                                    <option value="AAPL">Apple (AAPL)</option>
                                    <option value="MSFT">Microsoft (MSFT)</option>
                                    <option value="GOOGL">Google (GOOGL)</option>
                                    <option value="AMZN">Amazon (AMZN)</option>
                                    <option value="META">Meta (META)</option>
                                    <option value="NVDA">Nvidia (NVDA)</option>
                                    <option value="TSLA">Tesla (TSLA)</option>
                                    <option value="NFLX">Netflix (NFLX)</option>
                                    <option value="AMD">AMD (AMD)</option>
                                    <option value="INTC">Intel (INTC)</option>
                                    <option value="BRK-B">Berkshire Hathaway (BRK-B)</option>
                                    <option value="JNJ">Johnson & Johnson (JNJ)</option>
                                    <option value="V">Visa (V)</option>
                                    <option value="JPM">JPMorgan Chase (JPM)</option>
                                    <option value="WMT">Walmart (WMT)</option>
                                    <option value="PG">Procter & Gamble (PG)</option>
                                    <option value="KO">Coca-Cola (KO)</option>
                                    <option value="XOM">Exxon Mobil (XOM)</option>
                                    <option value="SPY">S&P 500 ETF (SPY)</option>
                                    <option value="QQQ">Nasdaq 100 ETF (QQQ)</option>
                                    <option value="VOO">S&P 500 ETF (VOO)</option>
                                    <option value="ARKK">ARK Innovation ETF (ARKK)</option>
                                    <option value="EEM">Emerging Markets ETF (EEM)</option>
                                    <option value="XLF">Financial Select Sector SPDR (XLF)</option>
                                    <option value="ES=F">S&P 500 E-mini (ES=F)</option>
                                    <option value="NQ=F">Nasdaq 100 E-mini (NQ=F)</option>
                                    <option value="YM=F">Dow Jones E-mini (YM=F)</option>
                                    <option value="RTY=F">Russell 2000 E-mini (RTY=F)</option>
                                    <option value="MES=F">Micro E-mini S&P 500 (MES=F)</option>
                                    <option value="MNQ=F">Micro E-mini Nasdaq 100 (MNQ=F)</option>
                                    <option value="MYM=F">Micro E-mini Dow (MYM=F)</option>
                                    <option value="M2K=F">Micro E-mini Russell 2000 (M2K=F)</option>
                                    <option value="GC=F">Gold (GC=F)</option>
                                    <option value="SI=F">Silver (SI=F)</option>
                                    <option value="CL=F">Crude Oil WTI (CL=F)</option>
                                    <option value="BZ=F">Brent Oil (BZ=F)</option>
                                    <option value="NG=F">Natural Gas (NG=F)</option>
                                    <option value="HG=F">Copper (HG=F)</option>
                                    <option value="ZC=F">Corn (ZC=F)</option>
                                    <option value="ZS=F">Soybeans (ZS=F)</option>
                                    <option value="ZW=F">Wheat (ZW=F)</option>
                                    <option value="VX=F">VIX (VX=F)</option>
                                    <option value="BTC=F">Bitcoin Futures (BTC=F)</option>
                                    <option value="ETH=F">Ethereum Futures (ETH=F)</option>
                                </select>
                            </div>
                            <div class="d-flex flex-wrap align-items-center gap-3 mb-2">
                                <!-- Remove Metric, Range, Window controls, Apply, Reset -->
                            </div>
                            <div id="market-legend" class="mb-2" style="font-size:1rem;color:#183153;font-weight:500;"></div>
                        </div>
                        <div class="card-section-vertical">
                            <div id="stock-trends-result" class="mb-2"></div>
                            <div id="market-slider" class="mb-2"></div>
                            <div class="chart-area"><div id="d3-stock-chart"></div></div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Event-Driven Volatility Explorer -->
            <div class="col-12 d-flex">
                <div class="card shadow-sm flex-fill d-flex flex-column">
                    <div class="card-body d-flex flex-column">
                        <div class="card-header-row">
                            <span class="card-title">Event-Driven Volatility Explorer</span>
                        </div>
                        <div class="card-section-vertical">
                            <div class="mb-2" style="color:#183153;font-size:1.04rem;">
                                <span style="font-size:1.1rem;">ðŸ“ˆ <b>rolling volatility</b> reveals when the stock experienced sharp price movements.<br>
                                ðŸ“° <b>Global news headlines</b> are fetched for the same period, capturing real-world context.<br>
                                ðŸ¤– <b>Each headline is scored using AI sentiment analysis</b>, highlighting emotional tone.<br>
                                ðŸ”— <b>By aligning both, the chart exposes clear correlations between news mood and market stress.</b></span>
                            </div>
                            <div class="d-flex flex-wrap align-items-center gap-2 mb-2" id="volatility-controls">
                                <label for="vol-window" class="form-label mb-0">Rolling Window (days):</label>
                                <input type="number" id="vol-window" class="form-control w-auto" value="10" min="1" style="max-width:80px;">
                                <label for="vol-years" class="form-label mb-0">Time Range (years):</label>
                                <input type="number" id="vol-years" class="form-control w-auto" value="2" min="1" style="max-width:80px;">
                                <button type="button" onclick="fetchAndRenderVolatilityCorrelation()" class="btn btn-dark-bbg">Fetch & Visualize</button>
                            </div>
                            <div class="mb-2" style="width:100%;max-width:700px;">
                                <div id="volatility-range-slider"></div>
                                <div class="d-flex justify-content-between mt-1">
                                    <span id="volatility-range-start" style="font-size:0.98rem;"></span>
                                    <span id="volatility-range-end" style="font-size:0.98rem;"></span>
                                </div>
                            </div>
                            <div class="chart-area"><div id="volatility-correlation-chart"></div></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@1.4.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/nouislider@15.7.1/dist/nouislider.min.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
    <script src="static/main.js"></script>
</body>
</html> 